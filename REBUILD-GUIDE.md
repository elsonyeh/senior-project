# ğŸ—ï¸ SwiftTaste Supabase æ•¸æ“šåº«é‡å»ºæŒ‡å—

## ğŸ” ç¬¬ä¸€æ­¥ï¼šè¨ºæ–·ç¾ç‹€

1. **ç™»å…¥ Supabase Dashboard**
   - è¨ªå•ï¼šhttps://supabase.com/dashboard
   - é¸æ“‡ä½ çš„é …ç›®ï¼š`ijgelbxfrahtrrcjijqf`

2. **åŸ·è¡Œè¨ºæ–·è…³æœ¬**
   - é€²å…¥ï¼šSQL Editor
   - è¤‡è£½ `database-diagnosis.sql` çš„å…§å®¹
   - é»æ“Š "Run" åŸ·è¡Œ
   - **ğŸ“¸ æˆªåœ–æˆ–è¨˜éŒ„æ‰€æœ‰çµæœ**

## ğŸ—ï¸ ç¬¬äºŒæ­¥ï¼šå®Œæ•´é‡å»º

1. **åŸ·è¡Œé‡å»ºè…³æœ¬**
   - åœ¨åŒä¸€å€‹ SQL Editor ä¸­
   - è¤‡è£½ `complete-rebuild.sql` çš„**å…¨éƒ¨å…§å®¹**
   - é»æ“Š "Run" åŸ·è¡Œ
   - **âš ï¸ æ³¨æ„è§€å¯Ÿæ˜¯å¦æœ‰éŒ¯èª¤è¨Šæ¯**

2. **é æœŸçµæœ**
   ```
   Verification | Tables created     | 4
   Verification | Triggers created   | 5  
   Verification | Functions created  | 4
   Verification | RLS policies created | 7
   ```

## ğŸ’¾ ç¬¬ä¸‰æ­¥ï¼šè¨­ç½®å­˜å„²æ¡¶

1. **å‰µå»ºé ­åƒå­˜å„²æ¡¶**
   - é€²å…¥ï¼šStorage
   - é»æ“Šï¼š"Create Bucket"
   - åç¨±ï¼š`avatars`
   - è¨­ç½®ç‚ºï¼š**Public bucket**

2. **è¨­ç½®å­˜å„²æ”¿ç­–**
   - é»æ“Š `avatars` bucket
   - é€²å…¥ "Policies" æ¨™ç±¤
   - é»æ“Š "New Policy"
   - é¸æ“‡ "Allow all operations"
   - æˆ–è€…æ‰‹å‹•æ·»åŠ ï¼š
     ```sql
     -- ç”¨æˆ¶å¯ä»¥ä¸Šå‚³è‡ªå·±çš„é ­åƒ
     CREATE POLICY "Avatar upload policy" ON storage.objects
       FOR INSERT WITH CHECK (
         bucket_id = 'avatars' 
         AND auth.uid()::text = (storage.foldername(name))[1]
       );
     
     -- æ‰€æœ‰äººå¯ä»¥æŸ¥çœ‹é ­åƒ
     CREATE POLICY "Avatar view policy" ON storage.objects
       FOR SELECT USING (bucket_id = 'avatars');
     
     -- ç”¨æˆ¶å¯ä»¥æ›´æ–°è‡ªå·±çš„é ­åƒ
     CREATE POLICY "Avatar update policy" ON storage.objects
       FOR UPDATE USING (
         bucket_id = 'avatars' 
         AND auth.uid()::text = (storage.foldername(name))[1]
       );
     ```

## ğŸ”§ ç¬¬å››æ­¥ï¼šæ¢å¾©æ‡‰ç”¨ç¨‹å¼

1. **æ¢å¾©æ­£å¸¸çš„ authService**
   - æˆ‘æœƒå¹«ä½ æŠŠ authService.js æ”¹å›ä½¿ç”¨æ•¸æ“šåº«ç‰ˆæœ¬
   - ç§»é™¤æœ¬åœ°å­˜å„²çš„è‡¨æ™‚æ–¹æ¡ˆ

2. **æ¸¬è©¦è¨»å†ŠåŠŸèƒ½**
   - å˜—è©¦è¨»å†Šæ–°ç”¨æˆ¶
   - æª¢æŸ¥æ˜¯å¦æˆåŠŸå‰µå»ºç”¨æˆ¶æª”æ¡ˆ

## âœ… å®Œæˆæª¢æŸ¥æ¸…å–®

- [ ] è¨ºæ–·è…³æœ¬åŸ·è¡Œå®Œæˆï¼Œæ²’æœ‰éŒ¯èª¤
- [ ] é‡å»ºè…³æœ¬åŸ·è¡Œå®Œæˆï¼Œæ‰€æœ‰é©—è­‰é€šé
- [ ] avatars å­˜å„²æ¡¶å‰µå»ºä¸¦è¨­ç½®æ”¿ç­–
- [ ] æ‡‰ç”¨ç¨‹å¼æ¢å¾©æ­£å¸¸æ•¸æ“šåº«æœå‹™
- [ ] ç”¨æˆ¶è¨»å†Šæ¸¬è©¦æˆåŠŸ
- [ ] æ”¶è—æ¸…å–®åŠŸèƒ½æ¸¬è©¦æˆåŠŸ
- [ ] æ­·å²è¨˜éŒ„åŠŸèƒ½æ¸¬è©¦æˆåŠŸ

## ğŸš¨ å¸¸è¦‹å•é¡Œæ’é™¤

### å•é¡Œ1ï¼šæ¬Šé™éŒ¯èª¤
- ç¢ºä¿ä½ åœ¨æ­£ç¢ºçš„é …ç›®ä¸­
- ç¢ºä¿ä½ æœ‰ Owner æˆ– Admin æ¬Šé™

### å•é¡Œ2ï¼šè¡¨å·²å­˜åœ¨éŒ¯èª¤
- é‡å»ºè…³æœ¬æœƒè‡ªå‹•æ¸…ç†èˆŠè¡¨
- å¦‚æœé‚„æœ‰å•é¡Œï¼Œè«‹å‘Šè¨´æˆ‘å…·é«”éŒ¯èª¤è¨Šæ¯

### å•é¡Œ3ï¼šè§¸ç™¼å™¨å‰µå»ºå¤±æ•—
- æª¢æŸ¥æ˜¯å¦æœ‰èªæ³•éŒ¯èª¤
- ç¢ºä¿ PostgreSQL ç‰ˆæœ¬å…¼å®¹ï¼ˆSupabase ä½¿ç”¨ PostgreSQL 15ï¼‰

## ğŸ“ éœ€è¦å¹«åŠ©ï¼Ÿ

å¦‚æœåœ¨ä»»ä½•æ­¥é©Ÿé‡åˆ°å•é¡Œï¼š
1. è¤‡è£½å®Œæ•´çš„éŒ¯èª¤è¨Šæ¯çµ¦æˆ‘
2. æˆªåœ– Supabase Dashboard çš„ç›¸é—œéƒ¨åˆ†
3. å‘Šè¨´æˆ‘åŸ·è¡Œåˆ°å“ªä¸€æ­¥å‡ºç¾å•é¡Œ

è®“æˆ‘å€‘ä¸€æ­¥æ­¥è§£æ±ºæ‰€æœ‰å•é¡Œï¼ğŸš€