# ğŸ”„ Firebase åˆ° Supabase è³‡æ–™é·ç§»æŒ‡å—

## ğŸ“‹ æ¦‚è¦½

æ­¤æ–‡ä»¶èªªæ˜å¦‚ä½•å°‡ SwiftTaste æ‡‰ç”¨ç¨‹å¼çš„é¤å»³è³‡æ–™å¾ Firebase Firestore é·ç§»åˆ° Supabase PostgreSQL è³‡æ–™åº«ã€‚

## ğŸ› ï¸ æº–å‚™å·¥ä½œ

### 1. ç¢ºèªç’°å¢ƒè®Šæ•¸

ç¢ºä¿ `server/.env` æª”æ¡ˆä¸­åŒ…å«ä»¥ä¸‹è¨­å®šï¼š

```env
# Supabase è¨­å®š
SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

### 2. åŸ·è¡Œè³‡æ–™åº« Schema

åœ¨ Supabase SQL Editor ä¸­åŸ·è¡Œ `supabase-restaurant-schema.sql` æ–‡ä»¶ï¼š

1. æ‰“é–‹ Supabase Dashboard
2. é€²å…¥ SQL Editor
3. è¤‡è£½è²¼ä¸Š `supabase-restaurant-schema.sql` å…§å®¹
4. åŸ·è¡Œ SQL æŒ‡ä»¤

## ğŸš€ åŸ·è¡Œé·ç§»

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ npm è…³æœ¬

```bash
npm run migrate-firebase
```

### æ–¹æ³•äºŒï¼šç›´æ¥åŸ·è¡Œ

```bash
node migrate-firebase-to-supabase.js
```

## ğŸ“Š é·ç§»éç¨‹

é·ç§»è…³æœ¬æœƒåŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š

1. **é€£æ¥ Firebase Firestore** - è®€å–ç¾æœ‰é¤å»³è³‡æ–™
2. **è³‡æ–™è½‰æ›** - å°‡ Firebase æ ¼å¼è½‰æ›ç‚º Supabase æ ¼å¼
3. **æ‰¹é‡åŒ¯å…¥** - åˆ†æ‰¹æ’å…¥é¤å»³è³‡æ–™åˆ° Supabase
4. **ç…§ç‰‡è™•ç†** - å°‡ Firebase Storage åœ–ç‰‡ä½œç‚ºå¤–éƒ¨é€£çµæ–°å¢
5. **çµæœå ±å‘Š** - é¡¯ç¤ºæˆåŠŸ/å¤±æ•—çµ±è¨ˆ

## ğŸ”„ è³‡æ–™å°æ‡‰

### Firebase â†’ Supabase æ¬„ä½å°æ‡‰

| Firebase æ¬„ä½ | Supabase æ¬„ä½ | èªªæ˜ |
|--------------|--------------|------|
| `id` | `firebase_id` | åŸå§‹ Firebase IDï¼ˆç”¨æ–¼é¿å…é‡è¤‡ï¼‰ |
| `name` | `name` | é¤å»³åç¨± |
| `type` | `category` | é¤å»³é¡å‹ |
| `address` | `address` | åœ°å€ |
| `rating` | `rating` | è©•åˆ† (0-5) |
| `priceRange` | `price_range` | åƒ¹æ ¼ç­‰ç´š ($=1, $$=2, $$$=3, $$$$=4) |
| `location.lat` | `latitude` | ç·¯åº¦ |
| `location.lng` | `longitude` | ç¶“åº¦ |
| `tags` | `tags` | æ¨™ç±¤é™£åˆ— |
| `photoURL` | `restaurant_images.image_url` | ç…§ç‰‡é€£çµï¼ˆå¤–éƒ¨ï¼‰ |
| - | `description` | è‡ªå‹•çµ„åˆ type + suggestedPeople |
| - | `featured` | è©•åˆ† â‰¥ 4.5 è‡ªå‹•è¨­ç‚ºæ¨è–¦ |
| - | `extra_data` | JSON æ ¼å¼å„²å­˜åŸå§‹è³‡æ–™ |

## âœ… é©—è­‰é·ç§»

é·ç§»å®Œæˆå¾Œï¼Œå¯é€éä»¥ä¸‹æ–¹å¼é©—è­‰ï¼š

### 1. æª¢æŸ¥é¤å»³æ•¸é‡

```sql
SELECT COUNT(*) FROM restaurants;
```

### 2. æª¢æŸ¥ç…§ç‰‡æ•¸é‡

```sql
SELECT COUNT(*) FROM restaurant_images;
```

### 3. æŸ¥çœ‹ç¯„ä¾‹è³‡æ–™

```sql
SELECT name, category, rating, price_range 
FROM restaurants 
LIMIT 5;
```

## ğŸ¯ å‰ç«¯æ›´æ–°

é·ç§»å®Œæˆå¾Œï¼Œå‰ç«¯æœƒè‡ªå‹•ï¼š

1. âœ… å¾ Supabase è®€å–é¤å»³è³‡æ–™
2. âœ… æ”¯æ´æ–°çš„è³‡æ–™æ ¼å¼é¡¯ç¤º
3. âœ… ç›¸å®¹èˆŠæ ¼å¼ï¼ˆæ¼¸é€²å¼æ›´æ–°ï¼‰
4. âœ… é¡¯ç¤ºåœ–ç‰‡ä¾†æºæ¨™ç±¤

## ğŸš¨ æ³¨æ„äº‹é …

### é‡è¤‡åŸ·è¡Œ

- è…³æœ¬æœƒæª¢æŸ¥ `firebase_id` é¿å…é‡è¤‡åŒ¯å…¥
- å¯ä»¥å®‰å…¨åœ°å¤šæ¬¡åŸ·è¡Œ

### è³‡æ–™å®Œæ•´æ€§

- åŸå§‹ Firebase è³‡æ–™æœƒä¿å­˜åœ¨ `extra_data` æ¬„ä½
- æ”¯æ´æ¼¸é€²å¼é·ç§»ï¼Œæ–°èˆŠæ ¼å¼ä¸¦å­˜

### éŒ¯èª¤è™•ç†

- æ‰¹é‡è™•ç†é¿å… API é™åˆ¶
- å€‹åˆ¥é¤å»³å¤±æ•—ä¸å½±éŸ¿æ•´é«”é·ç§»
- è©³ç´°éŒ¯èª¤æ—¥èªŒå”åŠ©é™¤éŒ¯

## ğŸ“ˆ æ•ˆèƒ½å„ªåŒ–

### è³‡æ–™åº«ç´¢å¼•

å·²è‡ªå‹•å»ºç«‹ä»¥ä¸‹ç´¢å¼•ï¼š
- `firebase_id` (å”¯ä¸€ç´¢å¼•)
- `category`
- `price_range` 
- `rating`
- `location` (è¤‡åˆç´¢å¼•)
- `is_active`
- `featured`

### API é™åˆ¶

- æ‰¹æ¬¡å¤§å°ï¼š5 ç­†/æ‰¹æ¬¡
- æ‰¹æ¬¡é–“å»¶é²ï¼š1 ç§’
- é¿å… Supabase API é™åˆ¶

## ğŸŠ å®Œæˆå¾Œ

é·ç§»æˆåŠŸå¾Œï¼š

1. âœ… æ‰€æœ‰é¤å»³è³‡æ–™å·²åœ¨ Supabase
2. âœ… å‰ç«¯è‡ªå‹•å¾ Supabase è¼‰å…¥
3. âœ… ç®¡ç†å“¡å¯åœ¨å¾Œå°ç®¡ç†é¤å»³
4. âœ… æ”¯æ´ç…§ç‰‡ä¸Šå‚³å’Œå¤–éƒ¨é€£çµ
5. âœ… å®Œæ•´çš„æœå°‹å’Œç¯©é¸åŠŸèƒ½

## ğŸ†˜ ç–‘é›£æ’è§£

### å¸¸è¦‹å•é¡Œ

**Q: é·ç§»ä¸­æ–·æ€éº¼è¾¦ï¼Ÿ**  
A: é‡æ–°åŸ·è¡Œè…³æœ¬ï¼Œå·²åŒ¯å…¥çš„è³‡æ–™æœƒè‡ªå‹•è·³éã€‚

**Q: ç…§ç‰‡ç„¡æ³•é¡¯ç¤ºï¼Ÿ**  
A: æª¢æŸ¥ Firebase Storage æ¬Šé™ï¼Œç¢ºä¿åœ–ç‰‡é€£çµå¯å…¬é–‹è¨ªå•ã€‚

**Q: ç’°å¢ƒè®Šæ•¸éŒ¯èª¤ï¼Ÿ**  
A: ç¢ºèª `server/.env` æª”æ¡ˆè·¯å¾‘å’Œå…§å®¹æ­£ç¢ºã€‚

### è¯çµ¡æ”¯æ´

å¦‚é‡åˆ°å•é¡Œï¼Œè«‹æª¢æŸ¥ï¼š
1. Console è¼¸å‡ºçš„éŒ¯èª¤è¨Šæ¯
2. Supabase Dashboard çš„ API æ—¥èªŒ
3. Firebase Console çš„å­˜å–æ¬Šé™

---

ğŸ‰ **æ­å–œï¼** æ‚¨å·²æˆåŠŸå®Œæˆ Firebase åˆ° Supabase çš„è³‡æ–™é·ç§»ï¼