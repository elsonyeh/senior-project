-- Fun Question Tags Schema for SwiftTaste Application
-- 趣味問題選項到標籤的映射表

-- 1. Fun Question Options to Tags Mapping Table
CREATE TABLE IF NOT EXISTS fun_question_option_tags (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  option_text VARCHAR(255) NOT NULL, -- 問題選項文字 (例如: "側背包", "Ｉ人", "貓派")
  tag_name VARCHAR(255) NOT NULL, -- 對應的標籤 (例如: "精緻", "安靜", "高級")
  weight DECIMAL(3,2) DEFAULT 1.0, -- 權重 (用於未來微調)
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 創建索引
CREATE INDEX IF NOT EXISTS idx_fun_question_option_tags_option ON fun_question_option_tags(option_text);
CREATE INDEX IF NOT EXISTS idx_fun_question_option_tags_tag ON fun_question_option_tags(tag_name);

-- 插入趣味問題標籤映射數據
INSERT INTO fun_question_option_tags (option_text, tag_name) VALUES
-- 問題1: 側背包 v.s. 後背包
('側背包', '精緻'), ('側背包', '咖啡廳'), ('側背包', '文青'), ('側背包', '小店'), ('側背包', '現代'), ('側背包', '簡約'), ('側背包', '工業'),
('後背包', '戶外'), ('後背包', '休閒'), ('後背包', '活力'), ('後背包', '大型'), ('後背包', '鄉村'), ('後背包', '舊'), ('後背包', '熱情'),

-- 問題2: 夏天沒有冷氣 v.s. 冬天只能穿短袖
('夏天沒有冷氣', '冰品'), ('夏天沒有冷氣', '涼拌'), ('夏天沒有冷氣', '清爽'), ('夏天沒有冷氣', '消暑'), ('夏天沒有冷氣', '咖啡廳'), ('夏天沒有冷氣', '喝'), ('夏天沒有冷氣', '冷'), ('夏天沒有冷氣', '現代'),
('冬天只能穿短袖', '熱湯'), ('冬天只能穿短袖', '火鍋'), ('冬天只能穿短袖', '暖和'), ('冬天只能穿短袖', '熱食'), ('冬天只能穿短袖', '現代'),

-- 問題3: 愛吃的東西都只能嘗一口 v.s. 只能吃不想吃的東西
('愛吃的東西都只能嘗一口', '暗浪漫'), ('愛吃的東西都只能嘗一口', '色彩繽紛'), ('愛吃的東西都只能嘗一口', '喜氣'), ('愛吃的東西都只能嘗一口', '現代'), ('愛吃的東西都只能嘗一口', '精緻餐飲'), ('愛吃的東西都只能嘗一口', '多樣'), ('愛吃的東西都只能嘗一口', '拼盤'), ('愛吃的東西都只能嘗一口', '小份'), ('愛吃的東西都只能嘗一口', '吃一點'),
('只能吃不想吃的東西', '特別'), ('只能吃不想吃的東西', '舊'), ('只能吃不想吃的東西', '鄉村'), ('只能吃不想吃的東西', '復古'), ('只能吃不想吃的東西', '精緻餐飲'), ('只能吃不想吃的東西', '瘋狂'),

-- 問題4: 一個人在無人島生活 v.s. 24小時跟一群人待在一起
('一個人在無人島生活', '簡約'), ('一個人在無人島生活', '現代'), ('一個人在無人島生活', '工業'), ('一個人在無人島生活', '西方風味'), ('一個人在無人島生活', '休閒'), ('一個人在無人島生活', '優雅'), ('一個人在無人島生活', '舒適'), ('一個人在無人島生活', '寧靜'), ('一個人在無人島生活', '精緻餐飲'), ('一個人在無人島生活', '自助服務'), ('一個人在無人島生活', '高級'), ('一個人在無人島生活', '貓'), ('一個人在無人島生活', '冷'), ('一個人在無人島生活', '私密'), ('一個人在無人島生活', '獨特'), ('一個人在無人島生活', '安靜'), ('一個人在無人島生活', '包廂'), ('一個人在無人島生活', '隱私'),
('24小時跟一群人待在一起', '熱情'), ('24小時跟一群人待在一起', '鄉村'), ('24小時跟一群人待在一起', '印度風味'), ('24小時跟一群人待在一起', '復古'), ('24小時跟一群人待在一起', '台式'), ('24小時跟一群人待在一起', '日式'), ('24小時跟一群人待在一起', '色彩繽紛'), ('24小時跟一群人待在一起', '友善'), ('24小時跟一群人待在一起', '開放式廚房'), ('24小時跟一群人待在一起', '自助餐'), ('24小時跟一群人待在一起', '休閒'), ('24小時跟一群人待在一起', '喜氣'), ('24小時跟一群人待在一起', '熱'), ('24小時跟一群人待在一起', '溫暖'), ('24小時跟一群人待在一起', '平價'), ('24小時跟一群人待在一起', '狗'), ('24小時跟一群人待在一起', '動感十足'), ('24小時跟一群人待在一起', '開放'), ('24小時跟一群人待在一起', '聚會'), ('24小時跟一群人待在一起', '熱鬧'), ('24小時跟一群人待在一起', '連鎖'),

-- 問題5: 黑巧克力 v.s. 白巧克力
('黑巧克力', '現代'), ('黑巧克力', '簡約'), ('黑巧克力', '美式'), ('黑巧克力', '工業'), ('黑巧克力', '西方風味'), ('黑巧克力', '深度'), ('黑巧克力', '濃郁'), ('黑巧克力', '成熟'), ('黑巧克力', '苦甜'),
('白巧克力', '昏暗浪漫'), ('白巧克力', '甜食'), ('白巧克力', '特別'), ('白巧克力', '溫和'), ('白巧克力', '輕盈'),

-- 問題6: 一生只能喝熱水 v.s. 一生只能喝冰水
('一生只能喝熱水', '熱飲'), ('一生只能喝熱水', '茶館'), ('一生只能喝熱水', '熱食'), ('一生只能喝熱水', '湯品'),
('一生只能喝冰水', '冰飲'), ('一生只能喝冰水', '冰品'), ('一生只能喝冰水', '冷食'), ('一生只能喝冰水', '清爽'),

-- 問題7: 會飛 v.s. 力大無窮
('會飛', '現代'), ('會飛', '簡約'), ('會飛', '西方風味'), ('會飛', '休閒'), ('會飛', '優雅'), ('會飛', '舒適'), ('會飛', '頂樓'), ('會飛', '景觀'), ('會飛', '高處'),
('力大無窮', '鄉村'), ('力大無窮', '復古'), ('力大無窮', '台式'), ('力大無窮', '日式'), ('力大無窮', '明亮活潑'), ('力大無窮', '動感十足'), ('力大無窮', '喜氣'), ('力大無窮', '友善'), ('力大無窮', '瘋狂'), ('力大無窮', '舊'), ('力大無窮', '飽足'), ('力大無窮', '重口味'), ('力大無窮', '大份量'), ('力大無窮', '烤肉'),

-- 問題8: 消除蚊子 v.s. 消除蟑螂
('消除蚊子', '熱情'), ('消除蚊子', '鄉村'), ('消除蚊子', '復古'), ('消除蚊子', '台式'), ('消除蚊子', '休閒'), ('消除蚊子', '喜氣'), ('消除蚊子', '現代'), ('消除蚊子', '友善'), ('消除蚊子', '舊'), ('消除蚊子', '室內'), ('消除蚊子', '精緻餐飲'), ('消除蚊子', '精緻'), ('消除蚊子', '空調'), ('消除蚊子', '舒適'),
('消除蟑螂', '現代'), ('消除蟑螂', '簡約'), ('消除蟑螂', '美式'), ('消除蟑螂', '西方風味'), ('消除蟑螂', '明亮活潑'), ('消除蟑螂', '休閒'), ('消除蟑螂', '優雅'), ('消除蟑螂', '舒適'), ('消除蟑螂', '精緻餐飲'), ('消除蟑螂', '寧靜'), ('消除蟑螂', '乾淨'), ('消除蟑螂', '衛生'), ('消除蟑螂', '明亮'), ('消除蟑螂', '精緻'),

-- 問題9: 回到過去 v.s. 去未來
('回到過去', '特別'), ('回到過去', '瘋狂'), ('回到過去', '溫暖'), ('回到過去', '狗'), ('回到過去', '友善'), ('回到過去', '休閒快餐'), ('回到過去', '工業'), ('回到過去', '復古'), ('回到過去', '舊'), ('回到過去', '喜氣'), ('回到過去', '休閒'), ('回到過去', '傳統'), ('回到過去', '老店'), ('回到過去', '經典'),
('去未來', '特別'), ('去未來', '瘋狂'), ('去未來', '現代'), ('去未來', '色彩繽紛'), ('去未來', '動感十足'), ('去未來', '精緻餐飲'), ('去未來', '自助服務'), ('去未來', '休閒'), ('去未來', '寧靜'), ('去未來', '舒適'), ('去未來', '優雅'), ('去未來', '創新'), ('去未來', '科技'), ('去未來', '異國'),

-- 問題10: 你會想生活在亞洲還是歐洲
('亞洲', '台式'), ('亞洲', '日式'), ('亞洲', '印度風味'), ('亞洲', '亞洲'), ('亞洲', '韓式'), ('亞洲', '中式'),
('歐洲', '美式'), ('歐洲', '西方風味'), ('歐洲', '歐式'), ('歐洲', '義式'), ('歐洲', '法式'), ('歐洲', '西式'),

-- 問題11: 一輩子只能吃飯或麵
('飯', '米食'), ('飯', '中式'), ('飯', '家常'), ('飯', '簡餐'),
('麵', '麵食'), ('麵', '義式'), ('麵', '拉麵'), ('麵', '快餐'),

-- 問題12: 刺激冒險 v.s. 平凡
('刺激冒險', '特別'), ('刺激冒險', '瘋狂'), ('刺激冒險', '喜氣'), ('刺激冒險', '熱情'), ('刺激冒險', '明亮活潑'), ('刺激冒險', '色彩繽紛'), ('刺激冒險', '動感十足'), ('刺激冒險', '特色'), ('刺激冒險', '異國'), ('刺激冒險', '創新'), ('刺激冒險', '獨特'),
('平凡', '簡約'), ('平凡', '明亮活潑'), ('平凡', '休閒'), ('平凡', '優雅'), ('平凡', '舒適'), ('平凡', '寧靜'), ('平凡', '家常'), ('平凡', '傳統'), ('平凡', '親民'), ('平凡', '連鎖'),

-- 問題13: 你是Ｉ人還是Ｅ人
('Ｉ人', '安靜'), ('Ｉ人', '包廂'), ('Ｉ人', '隱私'), ('Ｉ人', '小店'), ('Ｉ人', '簡約'), ('Ｉ人', '明亮'), ('Ｉ人', '休閒'), ('Ｉ人', '優雅'), ('Ｉ人', '舒適'),
('Ｅ人', '熱情'), ('Ｅ人', '明亮活潑'), ('Ｅ人', '動感十足'), ('Ｅ人', '色彩繽紛'), ('Ｅ人', '喜氣'), ('Ｅ人', '瘋狂'), ('Ｅ人', '特別'), ('Ｅ人', '鄉村'), ('Ｅ人', '活力'), ('Ｅ人', '熱鬧'), ('Ｅ人', '開放'), ('Ｅ人', '聚會'),

-- 問題14: 貓派v.s.狗派
('貓派', '貓'), ('貓派', '高級'), ('貓派', '寧靜'), ('貓派', '簡約'), ('貓派', '工業'), ('貓派', '優雅'), ('貓派', '舒適'), ('貓派', '溫馨'), ('貓派', '安靜'), ('貓派', '文青'), ('貓派', '小店'),
('狗派', '狗'), ('狗派', '熱情'), ('狗派', '鄉村'), ('狗派', '動感十足'), ('狗派', '喜氣'), ('狗派', '友善'), ('狗派', '平價'), ('狗派', '活力'), ('狗派', '戶外'), ('狗派', '開放式廚房'), ('狗派', '開放'),

-- 問題15: 高腳杯v.s.低腳杯
('高腳杯', '現代'), ('高腳杯', '簡約'), ('高腳杯', '美式'), ('高腳杯', '工業'), ('高腳杯', '明亮活潑'), ('高腳杯', '舊'), ('高腳杯', '西方風味'), ('高腳杯', '精緻餐飲'), ('高腳杯', '酒吧'), ('高腳杯', '精緻'), ('高腳杯', '高級'), ('高腳杯', '西式'),
('低腳杯', '現代'), ('低腳杯', '簡約'), ('低腳杯', '美式'), ('低腳杯', '工業'), ('低腳杯', '明亮活潑'), ('低腳杯', '休閒'), ('低腳杯', '優雅'), ('低腳杯', '舒適'), ('低腳杯', '友善'), ('低腳杯', '居酒屋'), ('低腳杯', '輕鬆'), ('低腳杯', '平價'), ('低腳杯', '親民'),

-- 問題16: 你覺得可能會有一見鍾情嗎？
('有', '熱情'), ('有', '美式'), ('有', '西方風味'), ('有', '昏暗浪漫'), ('有', '色彩繽紛'), ('有', '動感十足'), ('有', '喜氣'), ('有', '休閒快餐'), ('有', '瘋狂'), ('有', '溫暖'), ('有', '熱'), ('有', '現代'),
('沒有', '現代'), ('沒有', '簡約'), ('沒有', '休閒'), ('沒有', '優雅'), ('沒有', '舒適'), ('沒有', '寧靜'), ('沒有', '精緻餐飲'), ('沒有', '冷'), ('沒有', '貓'),

-- 問題17: 擁有永久的一字眉v.s.完全沒有眉毛
('一字眉', '現代'), ('一字眉', '簡約'), ('一字眉', '美式'), ('一字眉', '工業'), ('一字眉', '西方風味'),
('沒有眉毛', '鄉村'), ('沒有眉毛', '日式'), ('沒有眉毛', '台式'), ('沒有眉毛', '印度風味'), ('沒有眉毛', '動感十足')

ON CONFLICT DO NOTHING;

-- 創建視圖來方便查詢特定選項的所有標籤
CREATE OR REPLACE VIEW fun_question_tags_view AS
SELECT 
    option_text,
    array_agg(tag_name ORDER BY tag_name) as tags,
    array_agg(weight ORDER BY tag_name) as weights
FROM fun_question_option_tags 
GROUP BY option_text
ORDER BY option_text;